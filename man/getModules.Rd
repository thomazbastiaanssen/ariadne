% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AllGenerics.R, R/getModules.R
\name{getModules}
\alias{getModules}
\alias{addModules}
\alias{addModules,SummarizedExperiment-method}
\alias{getModules,SummarizedExperiment-method}
\title{Add information on modules of features or samples}
\usage{
getModules(x, modules, by = 1L, group = "taxonomy", exact.tax.level = FALSE)

addModules(x, modules, by = 1L, group = "taxonomy", exact.tax.level = FALSE)

\S4method{addModules}{SummarizedExperiment}(x, modules, by = 1L, group = "taxonomy", exact.tax.level = FALSE)

\S4method{getModules}{SummarizedExperiment}(x, modules, by = 1L, group = "taxonomy", exact.tax.level = FALSE)
}
\arguments{
\item{x}{a
\code{\link[SummarizedExperiment:SummarizedExperiment-class]{SummarizedExperiment}}.}

\item{modules}{\code{Named character list}. Named list of vectors, where each
vector is a module and its elements are the module members.}

\item{by}{\code{Numeric scalar} or \code{Character scalar}. Determines if
modules are added row-wise (\code{c(1L, "features")}) or column-wise.
(\code{C(2L, "samples")}). (Default: \code{1L}).}

\item{group}{\code{Character vector}. One or more variable names from
\code{rowData} or \code{colData}, depending on \code{by}. If set to
\code{"taxonomy"}, modules are derived from the combined taxonomic ranks.
(Default: \code{"taxonomy"})}

\item{exact.tax.level}{\code{Logical scalar}. Should only the deepest
taxonomic rank be used to determine whether a feature belongs to a module?
if \code{FALSE}, all ranks are considered. (Default: \code{FALSE}).}
}
\value{
\code{getModules} returns a \code{matrix} where rows and columns represent
features/samples and modules, respectively. \code{addModules} returns an
updated \code{\link[SummarizedExperiment:SummarizedExperiment-class]{SummarizedExperiment}}
object with the modules table in the \code{rowData} or \code{colData}.
}
\description{
\code{getModules} and \code{addModules} generate a logical modules table from
a list of of named vectors specifying which features or samples belong to
each module.
}
\details{
\code{getModules} and \code{addModules} allow to integrate information on
microbial modules into \code{rowData(x)} from databases like BugSigDB or
custom tables of microbes like \code{butyrate}. \code{sigs} must be a single
character vector or a list of character vectors, where each vector
corresponds to a module. Each microbial signature should follow the metaphlan
taxonomy format, e.g.,
\code{"k__Bacteria|p__Actinobacteria|c__Actinomycetia|o__Corynebacteriales"}.
}
\examples{
# Load butyrate module
data("butyrate", package = "ariadne")

# Load dataset
data("Tengeler2020", package = "mia")
tse <- Tengeler2020

# Convert butyrate table to module list
butyrate <- getFullTaxonomyLabels(butyrate)

# Generate modules table
mod.table <- getModules(tse, butyrate)

# Generate & store modules table
tse <- addModules(tse, modules)

# Make example list of two modules
modules <- list(A = c("g__Bacteroides", "f__Enterobacteriaceae"),
                B = c("c__Clostridia", "p__Cyanobacteria"))

# Match modules with only the deepest taxonomic rank of tse
mod.table <- getModules(tse, modules, exact.tax.level = TRUE)

# Make example list of three column modules
col.modules <- list(A = c("Cohort_1", "Cohort_3"),
                    B = c("Cohort_2"),
                    c("Cohort_1", "Cohort_2", "Cohort_3"))

Find column modules based on cohort variable
mod.table <- getModules(tse, col.modules, by = 2L, group = "cohort")

}
